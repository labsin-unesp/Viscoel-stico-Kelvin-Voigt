%--------------------------------------------------------------------------   
%                 IMPLEMENTAÇÃO NUMÉRICA - DISSERTAÇÃO
%              Universidade Estadual Paulista, FEIS/UNESP

%                               matrizB
%             Matriz da derivada das Funções interpoladoras

%------------------------------ MATRIZ B ----------------------------------


function [B11,B12,B13,B14,B15,B16,B17,B18,B21,B22,B23,B24,B25,B26,B27,B28,B31,B32,B33,B34,B35,B36,B37,B38]=matrizB(J11i,J12i,J21i,J22i,P)

np=length(P);
for n1=1:np,
    for n2=1:np,
        s1=P(n1);
        s2=P(n2);
        B11(n1,n2)=(1/4)*((-1+s2)*J11i(n1,n2)+(-1+s1)*J21i(n1,n2));
        B12(n1,n2)=0;
        B13(n1,n2)=(1/4)*((+1-s2)*J11i(n1,n2)+(-1-s1)*J21i(n1,n2));
        B14(n1,n2)=0;
        B15(n1,n2)=(1/4)*((+1+s2)*J11i(n1,n2)+(+1+s1)*J21i(n1,n2));
        B16(n1,n2)=0;
        B17(n1,n2)=(1/4)*((-1-s2)*J11i(n1,n2)+(+1-s1)*J21i(n1,n2));
        B18(n1,n2)=0;
        B21(n1,n2)=0;
        B22(n1,n2)=(1/4)*((-1+s2)*J12i(n1,n2)+(-1+s1)*J22i(n1,n2));
        B23(n1,n2)=0;
        B24(n1,n2)=(1/4)*((+1-s2)*J12i(n1,n2)+(-1-s1)*J22i(n1,n2));
        B25(n1,n2)=0;
        B26(n1,n2)=(1/4)*((+1+s2)*J12i(n1,n2)+(+1+s1)*J22i(n1,n2));
        B27(n1,n2)=0;
        B28(n1,n2)=(1/4)*((-1-s2)*J12i(n1,n2)+(+1-s1)*J22i(n1,n2));
        B31(n1,n2)=(1/4)*((-1+s2)*J12i(n1,n2)+(-1+s1)*J22i(n1,n2));
        B32(n1,n2)=(1/4)*((-1+s2)*J11i(n1,n2)+(-1+s1)*J21i(n1,n2));
        B33(n1,n2)=(1/4)*((+1-s2)*J12i(n1,n2)+(-1-s1)*J22i(n1,n2));
        B34(n1,n2)=(1/4)*((+1-s2)*J11i(n1,n2)+(-1-s1)*J21i(n1,n2));
        B35(n1,n2)=(1/4)*((+1+s2)*J12i(n1,n2)+(+1+s1)*J22i(n1,n2));
        B36(n1,n2)=(1/4)*((+1+s2)*J11i(n1,n2)+(+1+s1)*J21i(n1,n2));
        B37(n1,n2)=(1/4)*((-1-s2)*J12i(n1,n2)+(+1-s1)*J22i(n1,n2));
        B38(n1,n2)=(1/4)*((-1-s2)*J11i(n1,n2)+(+1-s1)*J21i(n1,n2));
    end
end